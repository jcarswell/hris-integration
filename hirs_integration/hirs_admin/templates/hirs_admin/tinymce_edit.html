{% extends "hirs_admin/base_edit.html" %}
{% load i18n static %}

{% block extra_js %}
<script src="{% static 'hirs_admin/dist/js/cookie.js' %}"></script>
<script src="{% static 'hirs_admin/dist/js/form.js' %}"></script>
<script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
<script>
tinymce.init({
  selector: 'textarea'
})
$("#form_list").submit(function(e) {
  e.preventDefault();
  form = $(this);
  data = serialize_form(form,$(this).serializeArray();)
  var b = 'submit';
  for(i=0;i<data.length;i++) {
    if (data[i].name == 'submit' || data[i].name == 'submit-new') {
      b = data[i].name;
      data.pop(i);
      break;
    }
  }

  $.ajax({
    method: "POST",
    url: location.href,
    data: data
  })
  .done(function(data) {
    doneProcess(data,form);
    if (data["status"] == "success") {
      if (data["id"] !== undefined) {
        if (b == 'submit') {
          location.replace(get_basepath() + data["id"] + '/');
        } else if (b == 'submit-new') {
          $(this).reset();
          location.reload(true);
        }
      } else {location.replace(get_basepath());}
    }
  })
  .fail(function(jqXHR,Status,error) {errorProcess(jqXHR,status,error);});
});
</script>
{% endblock %}